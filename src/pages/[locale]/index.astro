---
import BaseLayout from '@/layouts/BaseLayout.astro'
import ProductCard from '@/components/ProductCard'
import { listProducts, type MedusaProduct } from '@/lib/api'
import { getI18n, getLocaleFromParams } from '@/i18n/utils'
export { getLocaleStaticPaths as getStaticPaths } from '@/i18n/astro'

const locale = getLocaleFromParams(Astro.params)
const { t } = getI18n(locale)
const products = await listProducts({ limit: 8 })
const schema = {
  '@context': 'https://schema.org',
  '@type': 'WebSite',
  'name': t('common','siteName','Vape Import EC'),
  'url': Astro.site?.href || 'https://example.com'
}
---

<BaseLayout title={`${t('common','siteName','Vape Import EC')} | ${t('common','home.headline')}`} description={t('common','siteDescription')} {schema}>
  <section class="py-10 text-center">
    <h1 class="text-3xl sm:text-4xl font-bold">{t('common','home.headline')}</h1>
    <p class="text-gray-600 mt-2">{t('common','home.sub')}</p>
    <div class="mt-6">
      <a href={`/${locale}/products`} class="px-5 py-3 rounded bg-primary-600 text-white">{t('common','home.cta')}</a>
    </div>
  </section>

  <section class="mt-10">
    <div class="flex items-center justify-between mb-4">
      <h2 class="text-xl font-semibold">{t('common','home.popular')}</h2>
      <a href={`/${locale}/products`} class="text-sm">{t('common','home.viewAll')}</a>
    </div>
    {products.length === 0 ? (
      <p class="text-gray-600">{t('products','empty','No products available right now.')}</p>
    ) : (
      <div class="grid gap-6 sm:grid-cols-2 lg:grid-cols-4">
      {products.map((p: MedusaProduct) => (
        <ProductCard client:load product={p} labelAdd={t('products','addToCart')} locale={locale} />
      ))}
      </div>
    )}
  </section>
</BaseLayout>
